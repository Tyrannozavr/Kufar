# Kufar Scraper

Этот проект представляет собой скрапер для Kufar, предназначенный для уведомления пользователей о новых объявлениях через Telegram и email.

## Предварительные требования

- Docker
- Docker Compose

## Настройка и запуск

1. **Установите Docker и Docker Compose**
   
   Если вы еще не установили Docker, следуйте этим шагам:

   - Для Ubuntu:
     ```bash
     sudo apt-get update
     sudo apt-get install docker-ce docker-ce-cli containerd.io docker-compose-plugin
     ```

   - Для macOS:
     Скачайте и установите Docker Desktop с [официального сайта Docker](https://www.docker.com/products/docker-desktop)

   - Для Windows:
     Скачайте и установите Docker Desktop с [официального сайта Docker](https://www.docker.com/products/docker-desktop)

2. **Создайте файл .env**

   Создайте файл с именем `.env` в корневой директории проекта со следующим содержимым:

```env
# Telegram настройки
BOT_TOKEN=your_telegram_bot_token
CHAT_ID=your_telegram_chat_id
ENABLE_TELEGRAM=true

# Email настройки
SENDER_EMAIL=your_email@gmail.com
SENDER_PASSWORD=your_app_password
RECIPIENT_EMAIL=recipient@example.com
ENABLE_EMAIL=false

# Путь к файлу хранения данных (не изменяйте)
STORAGE_FILE=/app/data/listings_data.json
```

Замените placeholder значения на ваши реальные учетные данные.

3. **Запустите проект с помощью Docker Compose**

Перейдите в директорию проекта в терминале и выполните:

```bash
# Запуск в фоновом режиме
docker-compose up -d

# Просмотр логов
docker-compose logs -f

# Остановка
docker-compose down
```

## Настройки уведомлений

Проект поддерживает гибкую настройку уведомлений через переменные окружения:

- `ENABLE_TELEGRAM=true/false` - включить/отключить Telegram уведомления
- `ENABLE_EMAIL=true/false` - включить/отключить Email уведомления

## Сохранение данных

Все данные сохраняются в папке `./data/` на хосте и доступны между перезапусками контейнера. При первом запуске скрипт скачает все доступные страницы и создаст базу данных объявлений. При последующих запусках скрипт будет только добавлять новые объявления в существующую базу.

## Важные замечания

- Убедитесь, что ваш Gmail аккаунт имеет включенный доступ для менее безопасных приложений или используйте пароль приложения, если у вас включена двухфакторная аутентификация.
- Храните файл `.env` в безопасности и не делитесь им публично.
- Скрапер будет работать непрерывно. Для остановки используйте `docker-compose down`.

## Устранение неполадок

Если вы столкнулись с проблемами, проверьте следующее:

- Убедитесь, что все переменные окружения в файле `.env` правильно установлены.
- Проверьте, что ваша установка Docker обновлена.
- Убедитесь, что ваше интернет-соединение стабильно.
- Проверьте логи контейнера: `docker-compose logs -f`

Для любых других проблем, пожалуйста, создайте issue в репозитории проекта.